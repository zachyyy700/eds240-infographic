---
author: "Zach Loo"
execute:
    message: false
    warning: false
---

# Pre-Planning

1. My main goal for this infographic is to inform those who know nothing about horseracing, specifically in Japan. Recently, I've been thinking about what to include to accomplish this goal. Recently, I've been thinking about focusing in on a particular race, the Arima Kinen (AK). This is one of the most popular races that occurs in December every year and it's special since horse racing fans get to vote in which horses they want to run. Instead of summarizing all the race data in this dataset, focusing on this specific race could be more impactful.

2. I'm interesting in creating a general summary table for the AK, who have been the winners (`horse_name`), were they expected to win or did an underdog take home the win (`popular_rank`). There's also metrics also like `prize_money_10kY`, `horse_age`, and `margin` which is the measurement of difference in horse lengths of the horse in front of it at the finish (in this case I mainly look at the margin for 2nd place to see how close 1st & 2nd place are).

3. Infographic inspiration

Inspiration #1

![](inspo/tour-de-france.png)

Inspiration #2

![](inspo/rap-artists-likert.png)

```{r}
library(tidyverse)
library(scales)
library(gghighlight)
library(patchwork)
library(ggtext)
library(ggpubr)
library(showtext)

font_add_google("Playfair", "playfair")
font_add_google("Courier Prime", "courier")
```

```{r}
# Load data
jra_results <- read_csv(here::here('data', 'jra_clean.csv'), 
col_types = cols(race_id_horsenum = 'c', race_id = 'c', finish_time = 'c')) |> 
    
    # Convert time character to duration
    mutate(finish_time = as.duration(ms(finish_time)))
```

# Color Palette

```{r}
colors <- c(
    "deepred" = "#A4252A", 
    "red" = "#E74A22", 
    "orange" = "#F4BA1F", 
    "yellow" = "#F8F360", 
    "blue" = "#4392CE", 
    "green" = "#52b788", 
    "tan" = "#F9D1C5")

monochromeR::view_palette(colors)
```

# Recent AK Data

This dataset only goes up to 2021 and even the 2021 data isn't complete (up to 07-18-2021). Since I'm shifting my focus to just one race, the Arima Kinen, recent AK data can be manually compiled from the JRA official website. The following sections consist of:

1. Creating a new dataframe containing recent AK information 2021-2025

2. Joining on the original dataframe with `bind_rows()`

-  optional: translate Japanese labels for plotting

3. Resulting analysis.

# Arima Kinen Margins

```{r}
# Filter original df to AK margins for margins plot
ak_margins <- jra_results |> 
    filter(race_name == "有馬記念", final_position == 2) |> 
    select(race_date, horse_name, year, margin_horselen, margin_parsed) |> 
    mutate(n = row_number())
```

```{r}
# Compile recent margin data of interest, margins of horses that placed 2nd
ak_margins_recent <- tibble(
    race_date = c("2021-12-26", "2022-12-25", "2023-12-24", "2024-12-22", "2025-12-28"),
    horse_name = c("ディープボンド", "ボルドグフーシュ", "スターズオンアース", "シャフリヤール", "コスモキュランダ"),
    year = c(2021, 2022, 2023, 2024, 2025),
    margin_horselen = c("3/4", "2.1/2", "1/2", "ハナ", "1/2"),
    margin_parsed = c(0.75, 2.5, 0.5, 0.05, 0.5)
) |> 
    mutate(race_date = as.Date(race_date))

ak_margins_all <- bind_rows(ak_margins, ak_margins_recent) |> 
    mutate(n = row_number())
```

```{r}
ak_margins_all |> 
    group_by(margin_parsed) |> 
    summarise(count = n()) |> 
    ggplot(aes(count, margin_parsed)) +
    geom_point()
```

# Arima Kinen Winners

```{r}
# Filter original df to Arima Kinen & select columns of interest
ak_winners <- jra_results |> 
    filter(race_name == "有馬記念", final_position == 1) |> 
    select(race_id, race_date, year, distance_m, horse_num, horse_name, horse_age, finish_time, final_600m_time, win_odds_100Y, win_fav, prize_money_10kY, horse_trainer, horse_owner) 
```

```{r}
# Compile recent AK winners of interest
ak_winners_recent <- tibble(
    race_date = c("2021-12-26", "2022-12-25", "2023-12-24", "2024-12-22", "2025-12-28"),
    distance_m = c(2500),
    horse_num = c(10, 9, 5, 8, 4),
    horse_name = c("エフフォーリア", "イクイノックス", "ドウデュース", "レガレイラ", "ミュージアムマイル"),
    horse_age = c(3, 3, 4, 3, 3),
    finish_time = c("2:32.0", "2:32.4", "2:30.9", "2:31.8", "2:31.5"),
    final_600m_time = c(35.9, 35.4, 34.3, 34.9, 34.6),
    win_odds_100Y = c(2.1, 2.3, 5.2, 10.9, 3.8),
    win_fav = c(1, 1, 2, 5, 3),
    prize_money_10kY = c(30336.0, 40336.0, 50340.2, 50340.2, 50352.8), 
    year = c(2021, 2022, 2023, 2024, 2025),
    horse_trainer = c("鹿戸雄一", "木村哲也", "友道康夫", "木村哲也", "高柳大輔"),
    horse_owner = c("キャロットファーム", "シルクレーシング", "キーファーズ", "サンデーレーシング", "サンデーレーシング")
) |> 
    mutate(
        race_date = as.Date(race_date),
        finish_time = as.duration(ms(finish_time)))
```

```{r}
# Add new rows to outdated data
arima_kinen_all  <- bind_rows(ak_winners, ak_winners_recent) |> 
    mutate(
        n = row_number(), 
        annot = ifelse(n %% 5 == 0 & n != n(), TRUE, FALSE),
        avg_speed_m_s = distance_m / as.numeric(finish_time)) |> 

    mutate(win_fav_rev = abs(win_fav - 16), .after = win_fav)
```

This plot also needs an English horse name column so create a translate df to join on the data.

```{r}
# Create translation df
ak_names <- tibble(
  horse_name = c(
    "ダイナガリバー", "メジロデュレン", "オグリキャップ", "イナリワン", "ダイユウサク",
    "メジロパーマー", "トウカイテイオー", "ナリタブライアン", "マヤノトップガン", "サクラローレル",
    "シルクジャスティス", "グラスワンダー", "テイエムオペラオー", "マンハッタンカフェ", "シンボリクリスエス",
    "ゼンノロブロイ", "ハーツクライ", "ディープインパクト", "マツリダゴッホ", "ダイワスカーレット",
    "ドリームジャーニー", "ヴィクトワールピサ", "オルフェーヴル", "ゴールドシップ", "ジェンティルドンナ",
    "ゴールドアクター", "サトノダイヤモンド", "キタサンブラック", "ブラストワンピース", "リスグラシュー",
    "クロノジェネシス", "エフフォーリア", "イクイノックス", "ドウデュース", "レガレイラ",
    "ミュージアムマイル"
  ),
  horse_name_eng = c(
    "Dyna Gulliver", "Mejiro Durren", "Oguri Cap", "Inari One", "Daiyu Saku",
    "Mejiro Palmer", "Tokai Teio", "Narita Brian", "Mayano Top Gun", "Sakura Laurel",
    "Silk Justice", "Grass Wonder", "T M Opera O", "Manhattan Cafe", "Symboli Kris S",
    "Zenno Rob Roy", "Hearts Cry", "Deep Impact", "Matsurida Gogh", "Daiwa Scarlet",
    "Dream Journey", "Victoire Pisa", "Orfevre", "Gold Ship", "Gentildonna",
    "Gold Actor", "Satono Diamond", "Kitasan Black", "Blast Onepiece", "Lys Gracieux",
    "Chrono Genesis", "Efforia", "Equinox", "Do Deuce", "Regaleira",
    "Museum Mile"
  )
)

# Join on arima kinen df
arima_kinen_all <- left_join(arima_kinen_all, ak_names, by = 'horse_name') |> 
    # mutate(prize_money_usd = prize_money_10kY * 65.34, .after = prize_money_10kY) |> 
    relocate(horse_name_eng, .after = horse_name)
```

```{r}
# Create prize money label column
arima_kinen_all <- arima_kinen_all |> 
    mutate(prize_money_label = round(prize_money_10kY / 100, 1), .after = prize_money_10kY)
```

```{r fig.height=10, fig.width=9}
showtext_auto(enable = TRUE)
showtext_opts(dpi = 96)

ggplot(arima_kinen_all) + 

    # Dotted gridlines
    geom_segment(aes(x = 0, xend = 20000, y = n, yend = n), linetype = 'dotted', linewidth = 0.2) +
    
    # Year list
    geom_text(aes(x = -1000, y = n, label = year), size = 4) +

    # Winners list
    geom_richtext(aes(x = 3000, y = n, label = horse_name_eng), fill = "#F3F2EE", label.size = 0, label.padding = unit(0.1, "lines"), family = 'playfair', size = 5) +

    # Margin plot
    geom_segment(data = ak_margins_all, aes(x = 8000 - margin_parsed * 150, xend = 8000 + margin_parsed * 150, y = n, yend = n), linewidth = 3) +

    # Popular rank plot
    geom_segment(aes(x = 10000, xend = 10000 + win_fav_rev * 250, y = n, yend = n), linewidth = 2, color = colors[3], alpha = 0.6) +

    # Prize money plot
    geom_ribbon(aes(xmin = 14000, xmax = 14000 + prize_money_10kY * 0.115, y = n), orientation = 'y', position = 'identity', fill = colors[2], alpha = 0.6) +
    geom_point(data = subset(arima_kinen_all, annot), aes(x = 14000 + prize_money_10kY * 0.115, y = n), size = 1) +
    geom_richtext(data = subset(arima_kinen_all, annot), aes(x = 14000 + prize_money_10kY * 0.115 + 400, y = n, label = prize_money_label), fill = "#F3F2EE", hjust = 0, label.size = 0, label.padding = unit(0.1, "lines"), size = 3) +
    
    # Column titles
    annotate("text", x = c(-1000, 3000, 8000, 12000, 17000), y = -2, label = c("Year", "Winner", "Winning\nMargin Size", "Favorite-to-Win", "Prize Money"), size = 4.5, lineheight = 0.7) +
    # Vertical lines
    annotate("segment", x = c(-2000, 0, 6000, 10000, 14000, 20000), xend = c(-2000, 0, 6000, 10000, 14000, 20000), y = -3, yend = 41, linewidth = 0.3) +
    # Horizontal lines
    annotate("segment", x = -2000, xend = 20000, y = c(-3, -1, 41), yend = c(-3, -1, 41), linewidth = 0.3) +

    # Column unit labels
    annotate("text", x = c(10500, 13500), y = 0, label = c("Least", "Most"), hjust = c(0, 1), size = 3) +
    annotate("text", x = c(14500, 19500), y = 0, label = c("0", "¥500M"), hjust = c(0, 1), size = 3) +

    # Caption


    labs(title = "Arima Kinen Winners", caption = "Repeat Winners") +

    scale_y_reverse(expand = expansion(mult = 0.005)) +

    theme_void() +

    theme(
        plot.background = element_rect(fill = "#F3F2EE", color = NA),
        plot.margin = margin(10, 10, 10, 10),
        plot.title = element_text(family = 'playfair', size = 32, margin = margin(0, 0, 5, 10)),
        plot.caption = element_text(face = 'bold')
    )
```

```{r}
# showtext_opts(dpi = 320)
# # Save Arima Kinen Winners
# ggsave(here::here("outputs", paste0("ak_winners_", format(Sys.time(), "%Y%m%d_%H%M%S"), ".png")), dpi = 320, width = 9, height = 10)
```

# Arima Kinen Age Distribution

```{r}
# Create age df for all JRA races
jra_age <- jra_results |> 
    mutate(horse_age = ifelse(horse_age >= 10, "10+", as.character(horse_age))) |> 
    group_by(horse_age) |> 
    summarise(age_count = n()) |> 
    ungroup() |> 
    mutate(age_perc = age_count / sum(age_count)) |> 
    mutate(horse_age = factor(horse_age, levels = c("2", "3", "4", "5", "6", "7", "8", "9", "10+")))

# Create age df for just AK
ak_age <- arima_kinen_all |> 
    group_by(horse_age) |> 
    summarise(age_count = n()) |> 
    ungroup() |> 
    mutate(age_perc = age_count / sum(age_count)) |> 
    mutate(horse_age = factor(horse_age))
```

```{r}
# Combine age dfs
age_combined <- jra_age |> 
    select(horse_age, jra_perc = age_perc) |> 
    full_join(ak_age |> select(horse_age, ak_perc = age_perc), by = 'horse_age') |> 
    replace_na(list(ak_perc = 0)) 
    # pivot_longer(cols = c(jra_perc, ak_perc), names_to = 'type', names_pattern = "(.*)_perc", values_to = 'percent')
```

```{r}
ggplot(data = age_combined) +
    geom_segment(aes(x = horse_age, xend = horse_age, y = jra_perc, yend = ak_perc), color = 'grey69') +
    geom_point(aes(x = horse_age, y = jra_perc, color = "All Races"), size = 3) +
    geom_point(aes(x = horse_age, y = ak_perc, color = "Arima Kinen"), size = 3) +

    labs(x = "Horse Age", y = "Percentage", title = "Age & Performance", subtitle = "Comparison between the Arima Kinen and other JRA races.") +

    scale_color_manual(values = c("All Races" = 'grey59', "Arima Kinen" = colors[['deepred']])) +
    scale_y_continuous(labels = label_percent()) +

    theme_classic() +
    theme(
        panel.grid.major.y = element_line(color = 'grey59', linewidth = 0.5, linetype = 'dotted'),
        legend.title = element_blank())
```

# Arima Kinen Finish Times
How have finish times changed at the Arima Kinen?

```{r}
ggplot(arima_kinen_all, aes(year, finish_time)) +
    geom_line() +
    geom_point() +

    labs(x = "Year", y = "Finish Time (seconds)", title = "Arima Kinen 1st Place Times") +

    theme_classic() +

    scale_x_continuous(breaks = seq(1985, 2025, by = 5), labels = seq(1985, 2025, by = 5))

```

# Arima Kinen Prize Money Comparison
Since the Arima Kinen is one of the biggest races, how does 1st place prize money compare with other G1 races?

```{r}
# Create df for recent data, winners of different G1 races & 1st place prize
prize_g1_recent <- tribble(
    ~year, ~race_name, ~prize_money_10kY,
    2021, "東京優駿", 22718.8,
    #2021, "ジャパンカップ", 30382.2,
    2021, "有馬記念", 30336,
    2021, "宝塚記念", 15281.4,

    2022, "東京優駿", 22697.8,
    #2022, "ジャパンカップ", 40390.6,
    2022, "有馬記念", 40336,
    2022, "宝塚記念", 20378,

    2023, "東京優駿", 32734.9,
    #2023, "ジャパンカップ", 50386.4,
    2023, "有馬記念", 50340.2,
    2023, "宝塚記念", 22369.6,

    2024, "東京優駿", 32886.8,
    #2024, "ジャパンカップ", 50298.2,
    2024, "有馬記念", 50340.2,
    2024, "宝塚記念", 22273,

    2025, "東京優駿", 32771.3,
    #2025, "ジャパンカップ", 50378,
    2025, "有馬記念", 50352.8,
    2025, "宝塚記念", 30361.2,
)
```

```{r}
prize_g1 <- jra_results |> 
    filter(race_grade == "G1", race_name %in% c("有馬記念", "宝塚記念", "東京優駿"), final_position == 1, year != 2021) |> 
    select(year, race_name, prize_money_10kY)
```

```{r}
# Combine recent & original data
prize_g1_all <- bind_rows(prize_g1, prize_g1_recent)
```

```{r}
race_names_translate <- tibble(
    race_name = c("有馬記念", "宝塚記念", "東京優駿"),
    race_name_eng = c("Arima Kinen", "Takarazuka Kinen", "Tokyo Yushun")
)

prize_g1_all <- left_join(prize_g1_all, race_names_translate, by = 'race_name') 
```

```{r}
prize_g1_all <- prize_g1_all |> 
    mutate(race_name_eng = factor(race_name_eng, levels = c("Arima Kinen", "Tokyo Yushun", "Takarazuka Kinen")))
```

```{r}
ggplot(prize_g1_all) +
    geom_line(aes(x = year, y = prize_money_10kY, group = race_name_eng, color = race_name_eng), linewidth = 1.5) +

    labs(x = "Year", y = "Prize Money", color = "Race Name") +

    scale_y_continuous(labels = label_currency(prefix = "¥", suffix = "M", scale = 1/100)) +

    scale_color_manual(values = c(colors[['deepred']], colors[['green']], colors[['blue']])) +

    scale_x_continuous(breaks = seq(1990, 2025, by = 5)) +

    theme_classic() + 
    theme(panel.grid.major.y = element_line(color = 'grey59', linewidth = 0.5, linetype = 'dotted'))
```

# Arima Kinen Favorite Win Rate

```{r}
ak_fav_winrates <- arima_kinen_all |> 
    mutate(win_fav_bin = case_when(
        win_fav %in% c(1, 2, 3) ~ "1-3",
        win_fav %in% c(4, 5, 6) ~ "4-6",
        win_fav %in% c(7, 8, 9) ~ "7-9",
        win_fav >= 10 ~ "10+"
    ), .after = win_fav) |> 

    mutate(win_fav_bin = factor(win_fav_bin, levels = c("1-3", "4-6", "7-9", "10+")))
```

```{r}
ak_fav_winrates |> 
    group_by(win_fav_bin) |> 
    summarise(win_rate = n() / nrow(ak_fav_winrates)) |> 
    ggdonutchart(x = 'win_rate', label = 'win_fav_bin', lab.pos = 'in',
    color = 'white',
    fill = 'win_fav_bin',
    palette = c(colors[['orange']], colors[['yellow']], colors[['blue']], colors[['green']])) +

    labs(title = "Arima Kinen Winrates by Favorite Rank") +

    theme(legend.position = 'none')
```

# Prize Money Trend
First place prize money trends over the years, how do the different grades compare?

```{r}
# prize_money_usd <- jra_results_eng |> 
#     mutate(prize_money_usd = prize_money_10kY * 65.34) |> 
#     filter(listed_graded_race %in% c("G1", "G2", "G3"), final_position == 1, year != 2021) |> 
#     group_by(year, listed_graded_race) |> 
#     summarise(
#         mean_prize_usd = mean(prize_money_usd, na.rm = TRUE),
#         max_prize_usd = max(prize_money_usd, na.rm = TRUE)) |> 
#     ungroup() |> 

#     mutate(listed_graded_race = factor(listed_graded_race, levels = c("G1", "G2", "G3"))) |> 
#     rename(race_grade = listed_graded_race)
```

```{r}
# ggplot(prize_money_usd) +
#     geom_line(aes(year, mean_prize_usd, group = race_grade, color = race_grade, linetype = "Mean"), linewidth = 1.2) +
#     geom_line(aes(year, max_prize_usd, group = race_grade, color = race_grade, linetype = "Max"), alpha = 0.6, linewidth = 0.7) +

#     labs(x = "Year", y = "Dollar Amount", title = "Yearly 1st Place Reward Over Time", color = "Race Grade") +

#     scale_x_continuous(breaks = seq(1985, 2020, by = 5)) +
    
#     scale_y_continuous(labels = label_dollar()) +

#     scale_linetype_manual(values = c("Mean" = "solid", "Max" = "dashed"), name = "Stat") +

#     scale_color_manual(values = c("G1" = colors[5], "G2" = colors[2], "G3" = colors[6])) +

#     theme_classic()
```

# Favorite Win Rates
Favorite to win & actual winner win rates at different races, how good are fans at predicting the winner?

```{r}
# Create function to feed into map
# find_winrates <- function(data, race){
#     # Filter to race
#     race_only <- data |> 
#         filter(race_name == race)

#     # Various favorite's winrates
#     map_dfr(1:3, ~{
#         race_only |> 
#             filter(popular_rank == .x) |> 
#             summarise(win_rate = mean(final_position == 1, na.rm = TRUE), race_name = race)
#     }, .id = 'popular_rank') 
# }

# # Call function on race list
# race_list <- c("天皇賞(春)", "天皇賞(秋)", "有馬記念", "ジャパンカップ", "宝塚記念", "東京優駿")
# winrate_df <- map_dfr(race_list, ~{
#     find_winrates(jra_results_eng, race = .x)
# })
```

```{r}
# winrate_df <- winrate_df |> 
#     mutate(popular_rank = factor(popular_rank))
```

```{r}
# ggplot(winrate_df, aes(win_rate, race_name, fill = fct_rev(popular_rank))) +
#     geom_col(position = 'dodge') +

#     scale_y_discrete(labels = c("Japan Cup", "Tenno Sho (Spring)", "Tenno Sho (Autumn)", "Takarazuka Kinen", "Arima Kinen", "Tokyo Yushun")) +
    
#     labs(x = "Win Rate", y = "Race", fill = "Favorite-to-Win") +

#     scale_fill_manual(values = rev(c("#F4BA1F", "grey", "brown"))) +

#     scale_x_continuous(labels = label_percent()) +
#     guides(fill = guide_legend(reverse = TRUE)) +
#     theme_minimal()
```

# Distance Specialization

```{r}
# # Create distance category
# jra_results_eng <- jra_results_eng |> 
#     mutate(distance_category = case_when(
#         distance_m <= 1400 ~ "sprint",
#         distance_m > 1400 & distance_m <= 2000 ~ "medium", 
#         distance_m > 2000 ~ "long"
#     ))

# # Create english names df
# names_translations <- tibble(
#     horse_name = c("トウカイテイオー", "オグリキャップ", "ナリタブライアン", 
#                  "タイキシャトル", "テイエムオペラオー", "ウオッカ", 
#                  "エルコンドルパサー", "ロードカナロア", "キタサンブラック"),
#     horse_name_eng = c("Tokai Teio", "Oguri Cap", "Narita Brian", 
#                      "Taiki Shuttle", "T.M. Opera O", "Vodka", 
#                      "El Condor Pasa", "Lord Kanaloa", "Kitasan Black")
# )
```

```{r}
# Left join on english dataframe
# jra_results_eng <- left_join(jra_results_eng, names_translations, by = "horse_name")
```

```{r}
# Distance specialization
# distance_specialize <- jra_results_eng |> 
#     mutate(won = ifelse(final_position == 1, yes = 1, no = 0)) |> 
#     group_by(horse_name_eng, distance_category) |> 
#     summarise(wins = sum(won, na.rm = TRUE), races = n(), .groups = 'drop') |> 

#     mutate(win_rate = wins / races) |> 
#     arrange(desc(win_rate)) |> 
#     filter(horse_name_eng %in% names_translations$horse_name_eng) 
```

```{r}
# ggplot(distance_specialize, aes(x = wins, y = horse_name_eng, fill = distance_category)) +
#     geom_col(position = 'fill') +
#     geom_text(aes(label = wins), position = position_fill(vjust = 0.5)) +
#     scale_x_continuous(labels = label_percent()) +

#     labs(title = "Distance Specialization", subtitle = "Horses specialize in distance categories throughout their career.", x = "Win Percentage", y = "Horse Name", fill = "Category") +
    
#     scale_fill_manual(values = c("#1982c4", "#8ac926", "#ff595e")) +
#     theme_minimal()
```

# Runner Strategies
The "Path to Victory".

```{r}
# Pivot corner columns 
# jra_results_long <- jra_results_eng |> 
#     pivot_longer(cols = c(corner1_position:corner4_position, final_position),
#     names_to = "corner_number", names_pattern = "(.*)_position",
#     values_to = "position")
```

```{r}
# # Write function to create subplot
# create_horse_subplot <- function(data_long, race_name_input = "有馬記念", year_input, horse_name_input, plot_title_input, highlight_label){
#     data_long |> 
#         filter(race_name == race_name_input & year == year_input) |> 
#         ggplot(aes(x = corner_number, y = factor(position), group = horse_name, color = horse_name)) +
#         geom_line(linewidth = 1.5) +

#         labs(y = "Race Position", title = plot_title_input) +

#         # Reverse y-axis for more intuitive plot
#         scale_y_discrete(limits = rev) +

#         # Finish line
#         geom_vline(aes(xintercept = "final"), color = "black", linewidth = 1.2, linetype = "dashed") +

#         #geom_label(aes(x = "final", y = 2), label = "Finish") +
#         theme_minimal() +

#         # Highlight winner
#         gghighlight(horse_name == horse_name_input, 
#         label_params = list(
#             nudge_x = -1.5, nudge_y = -5, label = highlight_label
#         ), 
#         use_group_by = FALSE) +
        
#         theme(axis.title.x = element_blank())
# }
```

```{r}
# plot_front <- create_horse_subplot(jra_results_long, year_input = 2017, horse_name_input = "キタサンブラック", plot_title_input = "Strategy: Front", highlight_label = "Kitasan Black")

# plot_pace <- create_horse_subplot(jra_results_long, year_input = 1993, horse_name_input = "トウカイテイオー", plot_title_input = "Strategy: Late", highlight_label = "Tokai Teio")

# plot_end <- create_horse_subplot(jra_results_long, year_input = 2012, horse_name_input = "ゴールドシップ", plot_title_input = "Strategy: End", highlight_label = "Goldship")

# plot_front / plot_pace / plot_end
```



